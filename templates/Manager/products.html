{% extends 'Manager/base.html' %}

{% block title %}Products{% endblock %}

{% block content %}
<h2 class="mb-4">Product Management</h2>

<!-- Search & Filters -->
<div class="row mb-3">
    <div class="col-md-4">
        <input type="text" id="search" class="form-control" placeholder="Search products...">
    </div>
    <div class="col-md-3">
        <form method="GET" action="{% url 'products' %}">
            <select name="category" id="categoryFilter" class="form-select" onchange="this.form.submit()">
                <option value="">All Categories</option>
                {% for category in categories %}
                    <option value="{{ category.name }}" {% if request.GET.category == category.name %}selected{% endif %}>
                        {{ category.name }}
                    </option>
                {% endfor %}
            </select>
        </form>
        
    </div>
    <div class="col-md-3">
        <select id="stockFilter" class="form-select">
            <option value="">All Stock Status</option>
            <option value="in-stock">In Stock</option>
            <option value="out-of-stock">Out of Stock</option>
        </select>
    </div>
    <div class="col-md-2">
        <a href="{% url 'add_product' %}">
            <button class="btn btn-success w-100">➕ Add New Product</button>
        </a>
    </div>
</div>

<!-- Product List -->
<table class="table table-striped">
    <thead class="thead-dark">
        <tr>
            <th>Image</th>
            <th>Title</th>
            <th>Description</th>
            <th>Category</th>
            <th>Brand</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Rating</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for product in products %}
        <tr>
            <td>
                <img src="{{ product.display_image.url }}" alt="Product Image" width="50">
            </td>
            <td>{{ product.title }}</td>
            <td>{{ product.description|truncatewords:10 }}</td>
            <td>{{ product.category.name }}</td>
            <td>{{ product.brand|default:"N/A" }}</td>
            <td>${{ product.price }}</td>
            <td>{{ product.stock }}</td>
            <td>{{ product.rating }} ⭐</td>
            <td>
                {% comment %} <a href="{% url 'edit_product' product.id %}" class="btn btn-sm btn-primary">Edit</a>
                <a href="{% url 'delete_product' product.id %}" class="btn btn-sm btn-danger">Delete</a> {% endcomment %}
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="9" class="text-center">No products available</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
